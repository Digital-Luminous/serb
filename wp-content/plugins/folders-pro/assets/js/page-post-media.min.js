!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}((function(e,t){var o,s,a,r,d,l=[],n=-1,c=0,m=0,p="",f=-1,u=0,h="",v=folders_media_options.page_url,g="",j="",k=!1,y=!1,C=!1,x=0,w=0,b=[],I=null,S=null,E=0,D=null,T="",O=0,P="",A="",L=0,N=0,R=0,H=!1,F=folders_media_options.user_access,V=wp.media.view.AttachmentFilters.extend({id:"media-attachment-taxonomy-filter",createFilters:function(){var e={};folders_media_options.terms.length;_.each(folders_media_options.terms||{},(function(t,o){e[t.term_id]={text:t.name+" ("+t.trash_count+")",props:{media_folder:t.slug}}})),e.all={text:"All Folders",props:{media_folder:""},priority:10},e.unassigned={text:"(Unassigned)",props:{media_folder:"-1"},priority:10},this.filters=e},change:function(){var e={};_.each(folders_media_options.terms||{},(function(t,o){e[t.term_id]={text:t.name+" ("+t.trash_count+")",props:{media_folder:t.slug}}})),e.all={text:"Select a folder >>",props:{media_folder:""},priority:10},e.unassigned={text:"(Unassigned)",props:{media_folder:"-1"},priority:10},this.filters=e;var t=this.filters[this.el.value];t&&this.model.set(t.props)}}),U=0,M=0,J=wp.media.view.AttachmentsBrowser;wp.media.view.AttachmentsBrowser=wp.media.view.AttachmentsBrowser.extend({createToolbar:function(){J.prototype.createToolbar.call(this),this.toolbar.set("MediaLibraryOrganizerTaxonomyFilter",new V({controller:this.controller,model:this.collection.props,priority:-75}).render())}});var Y=wp.media.view.AttachmentFilters.extend({id:"media-attachment-dynamic-filter",createFilters:function(){var e={};folders_media_options.dynamic_folders.length;_.each(folders_media_options.dynamic_folders||{},(function(t,o){e[t.value]={text:t.name,props:{dynamic_media_folder:t.value}}})),this.filters=e},change:function(){var e={};_.each(folders_media_options.dynamic_folders||{},(function(t,o){e[t.value]={text:t.name,props:{dynamic_media_folder:t.value}}})),this.filters=e;var t=this.filters[this.el.value];t&&this.model.set(t.props)}}),z=wp.media.view.AttachmentsBrowser;wp.media.view.AttachmentsBrowser=wp.media.view.AttachmentsBrowser.extend({createToolbar:function(){z.prototype.createToolbar.call(this),this.toolbar.set("DynamicTaxonomyFilter",new Y({controller:this.controller,model:this.collection.props,priority:-75}).render())}});var K,B=wp.media.model.Query;_.extend(B,{get:(K=[],function(e,t){var o,s={},a=B.orderby,r=B.defaultProps;return delete e.query,delete e.cache,_.defaults(e,r),_.each(["include","exclude"],(function(t){e[t]&&!_.isArray(e[t])&&(e[t]=[e[t]])})),_.each(e,(function(e,t){_.isNull(e)||(s[B.propmap[t]||t]=e)})),_.defaults(s,B.defaultArgs),s.orderby=a.valuemap[e.orderby]||e.orderby,K=[],o||(o=new B([],_.extend(t||{},{props:e,args:s})),K.push(o)),o})});var X=window.wp;void 0!==X&&"function"==typeof X.Uploader&&(X.media.view.Modal.prototype.on("open",(function(){"",setTimeout((function(){e(".folder-modal #media-attachment-taxonomy-filter").length&&("all"==e(".folder-modal #media-attachment-taxonomy-filter").val()&&(e(".folder-modal #media-attachment-taxonomy-filter option:gt(1)").remove(),_.each(folders_media_options.terms,(function(t,o){e(".folder-modal #media-attachment-taxonomy-filter").append("<option value='"+t.term_id+"'>"+t.name+" ("+t.trash_count+")</option>")}))),e("#wcp-content").length||e(".editor-post-featured-image").length&&e(".attachment-filters").val("all").trigger("change"))}),200)})),X.media.view.Modal.prototype.on("close",(function(){;""})),e.extend(X.Uploader.prototype,{progress:function(){},init:function(){this.uploader&&(this.uploader.bind("FileFiltered",(function(t,o){U++,e(".folder-meter").css("width","0%"),e(".media-folder-loader").show(),e("#total_upload_files").text(U)})),this.uploader.bind("BeforeUpload",(function(t,o){var s=n,a=t.settings.multipart_params;if((s=parseInt(s))>0&&(a.folder_for_media=s),M<U){e(".media-folder-loader").show();var r=M/U*100;e(".folder-meter").css("width",r+"%")}M++,e("#current_upload_files").text(M)})),this.uploader.bind("UploadComplete",(function(t,o){window.wp;n=-1,e(".folder-meter").css("width","100%"),setTimeout((function(){e(".media-folder-loader").hide(),e(".folder-meter").css("width","0%"),U=0,M=0}),1250),W=e.ajax({url:folders_media_options.ajax_url,data:"type=attachment&action=wcp_get_default_list&active_id=0",method:"post",beforeSend:function(){null!=W&&W.abort()},success:function(t){t=e.parseJSON(t),b=t.taxonomies,_e(),e(".all-posts .total-count").text(t.total_items),e(".un-categorized-posts .total-count").text(t.empty_items)}})})))}}));var W,Q=window.wp;if(void 0!==Q&&"function"==typeof Q.Uploader){var G=window.wp.media,q=G.view.Modal;G.view.Modal=G.view.Modal.extend({className:"folder-modal",initialize:function(){q.prototype.initialize.apply(this,arguments)},open:function(){q.prototype.open.apply(this,arguments)&&(e(".folder-modal").length||e(".supports-drag-drop").length&&e(".supports-drag-drop").each((function(){"block"!=e(this).css("display")&&"inline-block"!=e(this).css("display")||e(this).addClass("folder-modal")})),e(".folder-modal").length?(e(".folder-custom-menu").remove(),e(".folder-modal .media-frame-tab-panel").removeClass("has-folder-menu"),e(".folder-modal .media-frame").hasClass("hide-menu")?e(".folder-custom-menu").length||(e(".folder-modal .media-frame-tab-panel").before("<div class='folder-custom-menu'><div class='folder-menu-content'><div class='cssload-container'><div class='cssload-tube-tunnel'></div></div></div></div>"),e(".folder-modal .folder-menu-content").load(folders_media_options.media_page_url+"?media_folder= #wcp-content-resize",(function(){ke(),ne(),ee()}))):e(".folder-custom-menu").length||(e(".folder-modal .media-frame-menu").addClass("has-folder-menu"),e(".folder-modal .media-frame-menu .media-menu").append("<div class='folder-custom-menu'><div class='folder-menu-content'><div class='cssload-container'><div class='cssload-tube-tunnel'></div></div></div></div>"),e(".folder-modal .folder-menu-content").load(folders_media_options.media_page_url+"?media_folder= #wcp-content-resize",(function(){ke(),ne(),ee()}))),e(".folder-form-data").remove(),e(".media-frame-tab-panel:first").before("<div class='folder-form-data'></div>"),e(".folder-form-data").html(folders_media_options.form_content)):setTimeout((function(){-1!=n&&e("#media-attachment-taxonomy-filter").each((function(){e(this).val(n),e(this).trigger("change")}))}),1e3))},close:function(){q.prototype.close.apply(this,arguments),e(".folder-modal").removeClass("folder-modal")}})}function Z(){"yes"==folders_media_options.useFolderUndo&&(e("#do-undo").addClass("active"),e(".undo-folder-action").removeClass("disabled"),setTimeout((function(){e("#do-undo").removeClass("active"),e(".undo-folder-action").addClass("disabled")}),parseInt(folders_media_options.defaultTimeout)))}function $(){"admin"!=F&&"view-edit"!=F||(e("#js-tree-menu .jstree-anchor:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",tolerance:"pointer",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){c=e(this).closest("li.jstree-node").attr("id"),e(".media-modal #js-tree-menu .jstree-clicked").length&&(g=e(".media-modal #js-tree-menu .jstree-clicked").closest(".jstree-node").attr("id")),o.draggable.hasClass("wcp-move-multiple")?e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each((function(){chkStr+=e(this).val()+","})),h=ie(c,"nonce"),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(me(),Z()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,h=ie(c,"nonce"),chkStr=postID+",",e(".wp-list-table input:checked").each((function(){e(this).val()!=postID&&(chkStr+=e(this).val()+",")})),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(me(),Z()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,h=ie(c,"nonce"),e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each((function(){chkStr+=e(this).data("id")+","}))),j=chkStr,e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Z(),Ce()}}))}}),e(".media-frame:not(.hide-router) .attachments-browser li.attachment:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:function(t,o){e(".selected-items").remove();var s=e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").length;return e("<div class='selected-items'><span class='total-post-count'>"+(s=0==s||1==s?"1 Item":s+" Items")+" Selected</span></div>")},start:function(t,o){e("body").addClass("no-hover-css")},cursor:"move",appendTo:".media-modal",cursorAt:{left:0,top:0},stop:function(t,o){e(".selected-items").remove(),e("body").removeClass("no-hover-css")}}),e(".un-categorised-items:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-hover-list",tolerance:"pointer",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){c=-1,h=folders_media_options.nonce,o.draggable.hasClass("wcp-move-multiple")?e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each((function(){chkStr+=e(this).val()+","})),te(chkStr)):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,chkStr=postID+",",e(".wp-list-table input:checked").each((function(){postID!=e(this).val()&&(chkStr+=e(this).val()+",")})),te(chkStr)):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each((function(){chkStr+=e(this).data("id")+","}))),j=chkStr,te(chkStr))}}),e(".tree-structure .folder-item:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover-list",tolerance:"pointer",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){e("body").removeClass("no-hover-css"),e(".media-modal #js-tree-menu .jstree-clicked").length&&(g=e(".media-modal #js-tree-menu .jstree-clicked").closest(".jstree-node").attr("id")),c=e(this).data("id"),o.draggable.hasClass("wcp-move-multiple")?(h=ie(c,"nonce"),e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each((function(){chkStr+=e(this).val()+","})),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Ce(),Z()}}))):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,h=ie(c,"nonce"),chkStr=postID+",",e(".wp-list-table input:checked").each((function(){e(this).val()!=postID&&(chkStr+=e(this).val()+",")})),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Ce(),Z()}})):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,h=ie(c,"nonce"),e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each((function(){chkStr+=e(this).data("id")+","}))),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Ce(),Z()}}))}}),e(".sticky-folders > ul > li > a:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .media-frame:not(.hide-router) .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",tolerance:"pointer",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){if(c=e(this).closest("li").data("folder-id"),e(".media-modal #js-tree-menu .jstree-clicked").length&&(g=e(".media-modal #js-tree-menu .jstree-clicked").closest(".jstree-node").attr("id")),o.draggable.hasClass("wcp-move-multiple")){if(e(".wp-list-table input:checked").length){var s="";e(".wp-list-table input:checked").each((function(){s+=e(this).val()+","})),h=ie(c,"nonce"),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(me(),Ce(),Z()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}}else if(o.draggable.hasClass("wcp-move-file")){var a=o.draggable[0].attributes["data-id"].nodeValue;h=ie(c,"nonce"),s=a+",",e(".wp-list-table input:checked").each((function(){e(this).val()!=a&&(s+=e(this).val()+",")})),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(me(),Z(),Ce()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}else if(o.draggable.hasClass("attachment")){s=o.draggable[0].attributes["data-id"].nodeValue;h=ie(c,"nonce"),e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").length>1&&(s="",e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").each((function(){s+=e(this).data("id")+","}))),j=s,e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+c+"&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Z(),Ce()}})}}}))}function ee(){e("#dynamic-tree-folders").jstree({core:{cache:!1,animation:0,dnd:{is_draggable:function(e){return!1}}},data:{cache:!1},select_node:!1,search:{show_only_matches:!0,case_sensitive:!1,fuzzy:!1},plugins:["dnd","search"]}).bind("ready.jstree",(function(){e(".dynamic-tree-data").show()})),e(".upload-media-action").removeClass("disabled"),e("#upload_media_folder").prop("disabled",!1),e(".folder-modal #js-tree-menu").jstree({core:{cache:!1,animation:0,check_callback:function(t,o,s,a,r){if(e("*").removeClass("drag-bot").removeClass("drag-in").removeClass("drag-up"),("move_node"===t||"copy_node"===t)&&r&&r.dnd)switch(r.pos){case"a":r.origin.get_node(r.ref,!0).addClass("drag-bot"),nodeId=e(".drag-bot").attr("id"),e("#jstree-dnd").text("Below "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"i":r.origin.get_node(r.ref,!0).addClass("drag-in"),nodeId=e(".drag-in").attr("id"),e("#jstree-dnd").text("Inside "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"b":r.origin.get_node(r.ref,!0).addClass("drag-up"),nodeId=e(".drag-up").attr("id"),e("#jstree-dnd").text("Above "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;default:e("#jstree-dnd").text(e("#jstree-dnd").data("txt"))}return!0}},dnd:{is_draggable:function(t){return"view-only"!=F&&(folderMoveId=t[0].id,!e(".jstree-node[id='"+folderMoveId+"']").length||!e(".jstree-node[id='"+folderMoveId+"']").hasClass("is-locked"))}},data:{cache:!1},select_node:!1,search:{show_only_matches:!0,case_sensitive:!1,fuzzy:!1},plugins:["dnd","search","contextmenu"],contextmenu:{select_node:0,show_at_node:0,items:function(){return{}}}}).bind("ready.jstree",(function(){if(re(),$(),le(),""!=folders_media_options.default_folder&&0!=folders_media_options.default_folder){var t=function(e){if(l.length>0)for(i=0;i<l.length;i++)if(l[i].slug==e)return l[i].folder_id;return""}(folders_media_options.default_folder);""!=t&&(e(".folder-modal #media-attachment-taxonomy-filter option[value='"+t+"']").length?(e(".folder-modal #media-attachment-taxonomy-filter").val(t).trigger("change"),e(".folder-modal #js-tree-menu .jstree-clicked").removeClass("jstree-clicked"),e(".folder-modal #js-tree-menu").jstree("select_node",t),e(".folder-modal #js-tree-menu .jstree-node[id='"+t+"'] > a").addClass("jstree-clicked")):e(".folder-modal select[name='folder_for_media']").val(t))}ae()})).bind("after_open.jstree",(function(){$()})).bind("open_all.jstree",(function(){$()})).bind("create_node.jstree",(function(){$()})).bind("delete_node.jstree",(function(){$()})).bind("close_all.jstree",(function(){$()})).bind("after_close.jstree",(function(){$()})).bind("move_node.jstree",(function(t,o){"#"!=o.node.parent&&e("#js-tree-menu").jstree("open_node",o.node.parent),re(),folderMoveId=o.node.id,orderString="",e(".folder-modal .jstree-node[id='"+folderMoveId+"']").closest("ul").children().each((function(){"undefined"!=e(this).attr("id")&&(orderString+=e(this).attr("id")+",")})),e(".folder-modal #"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?parentID=e("#"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().attr("id"):parentID=0,""!=orderString&&(a=o.old_parent,r=o.old_position,d=folderMoveId,e(".form-loader-count").css("width","100%"),e.ajax({url:folders_media_options.ajax_url,data:{term_ids:orderString,action:"wcp_save_folder_order",type:folders_media_options.post_type,nonce:folders_media_options.nonce,term_id:folderMoveId,parent_id:parentID},method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(e("#wcp_folder_parent").html(t.options),e(".form-loader-count").css("width","0"),me(),Ce(),_e(),$()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show(),window.location.reload(!0))}}))})),$()}function te(t){e(".folder-modal #js-tree-menu .jstree-anchor.jstree-clicked").length?(g=e(".folder-modal #js-tree-menu .jstree-anchor.jstree-clicked").closest(".jstree-node").attr("id"),e.ajax({url:folders_media_options.ajax_url,data:{post_id:t,action:"premio_check_for_other_folders",active_folder:g,type:folders_media_options.post_type,folder_id:-1,nonce:folders_media_options.nonce,status:folders_media_options.taxonomy_status,taxonomy:g},method:"post",success:function(t){-1==(t=e.parseJSON(t)).status?(e("#unassigned_folders").val(t.data.post_id),e("#confirm-your-change").show()):(me(),Z())}})):(h=folders_media_options.nonce,e.ajax({url:folders_media_options.ajax_url,data:"post_id="+t+"&type="+folders_media_options.post_type+"&action=wcp_remove_post_folder&folder_id="+"-1&nonce="+h+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+g,method:"post",success:function(e){me(),Z()}}))}function oe(t,o){e(".form-loader-count").css("width","100%");var s=0;0==g&&(s=e("#js-tree-menu > ul > li").length);var a=[];"custom"==t&&e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0&&e("#js-tree-menu input.checkbox:checked").each((function(){a.push(parseInt(e(this).closest("li.jstree-node").attr("id")))})),e.ajax({url:folders_media_options.ajax_url,data:{copy_from:t,copy_to:o,action:"copy_premio_folders",nonce:folders_media_options.nonce,post_type:folders_media_options.post_type,folder_order:s,folders:a},method:"post",success:function(t){if(1==(t=e.parseJSON(t)).status&&(N=t.parent_id,t.data.length>0))for(var o=0;o<t.data.length;o++)se(t.data[o]);Ce()}})}function se(t){var o={folder_id:t.term_id,folder_count:0,is_sticky:t.is_sticky,is_high:t.is_high,is_locked:t.is_locked,has_color:t.has_color,nonce:t.nonce,slug:t.slug,is_deleted:0};l.push(o);var s=t.title;if(s=s.replace(/\\/g,""),e("#js-tree-menu").jstree().create_node(t.parent_id,{id:t.term_id,text:s},"last",(function(){e(".jstree-node[id='"+t.term_id+"']").attr("data-nonce",t.nonce),e(".jstree-node[id='"+t.term_id+"']").attr("data-slug",t.slug)})),t.child.length>0)for(var a=0;a<t.child.length;a++)se(t.child[a]);pe(),le(),me(),e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active")}),5e3)}function ae(){if(e(".cut-folder-action, .copy-folder-action, .paste-folder-action, .delete-folder-action").addClass("disabled"),e("#js-tree-menu .jstree-anchor.jstree-clicked").length&&(e(".copy-folder-action, .delete-folder-action").removeClass("disabled"),""!=O&&0!=O&&g!=O&&e(".paste-folder-action").removeClass("disabled"),e("#menu-checkbox").is(":checked")||e(".cut-folder-action").removeClass("disabled")),e(".all-posts").hasClass("active-item")&&""!=O&&0!=O&&"custom"!=O&&e(".paste-folder-action").removeClass("disabled"),(e("#menu-checkbox").is(":checked")||e("#menu-checkbox").is(":checked"))&&e("#js-tree-menu input.checkbox:checked").length>0&&e(".delete-folder-action").removeClass("disabled"),e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0&&e(".copy-folder-action").removeClass("disabled"),e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0){var t=1;e("#js-tree-menu input.checkbox:checked").each((function(){e(this).closest("li.jstree-node").find("input:checked").length>1&&(t=0)})),t&&e(".cut-folder-action").removeClass("disabled"),e("#js-tree-menu .jstree-anchor.jstree-clicked").length&&e("#js-tree-menu .jstree-anchor.jstree-clicked input:checked").length}}function re(){e("#js-tree-menu .jstree-node").each((function(){var t=parseInt(e(this).data("count"));t>0?e(".jstree-node[id='"+e(this).attr("id")+"'] > a span.premio-folder-count").text(t):e(".jstree-node[id='"+e(this).attr("id")+"'] > a span.premio-folder-count").text(0)})),""!=g&&0!=g&&e(".jstree-node[id='"+g+"']").length&&(e("#js-tree-menu").jstree("select_node",g),e(".sticky-folders .sticky-folder-"+g+" a").length&&e(".sticky-folders .sticky-folder-"+g+" a").addClass("active-item")),e(".ajax-preloader").hide(),e(".js-tree-data").show(),ne(),le(),e(".sticky-folders ul > li").length>0&&e(".sticky-folders").addClass("active"),ue()}function ie(e,t){if(l.length>0)for(i=0;i<l.length;i++)if(parseInt(l[i].folder_id)==parseInt(e))return l[i][t];return""}function de(e){if(l.length>0)for(i=0;i<l.length;i++)if(parseInt(l[i].folder_id)==parseInt(e))return i;return null}function le(){e(".sticky-folders > ul").html("");var t="";if(e("#js-tree-menu li.jstree-node.is-sticky").each((function(){var o=e(this).attr("id"),s=e.trim(e("#js-tree-menu").jstree(!0).get_node(o).text),a=e("#"+o+"_anchor .premio-folder-count").text(),r=e("li.jstree-node[id='"+o+"']").hasClass("is-high")?" is-high ":"",i=e("li.jstree-node[id='"+o+"']").hasClass("is-locked")?" is-locked ":"";t+="<li data-folder-id='"+o+"' class='sticky-fldr "+r+" "+i+" sticky-folder-"+o+"'><a href='javascript:;'><span class='folder-title'>"+s+"</span><span class='folder-actions'><span class='update-inline-record'><i class='pfolder-edit-folder'></i></span><span class='star-icon'><i class='pfolder-star'></i></span><span class='dashicons dashicons-lock'></span><span class='premio-folder-count'>"+a+"</span></span></a></li>"})),e(".sticky-folders > ul").html(t),e(".jstree-anchor.jstree-clicked").length){var o=e(".jstree-anchor.jstree-clicked").closest("li.jstree-node").attr("id");e(".sticky-folders .sticky-folder-"+o+" a").addClass("active-item")}e(".sticky-folders > ul > li").length>0?e(".sticky-folders").addClass("active"):e(".sticky-folders").removeClass("active"),ne()}function ne(){var t=e(window).height()-e("#wpadminbar").height()-e(".sticky-wcp-custom-form").height()-70;e("#custom-scroll-menu").height(t),e("#custom-scroll-menu").overlayScrollbars({resize:"none",sizeAutoCapable:!0,autoUpdateInterval:33,x:"scroll",clipAlways:!1,y:"scroll"}),e(".folder-modal .custom-scroll-menu").hasClass("hor-scroll")&&(jQuery("#custom-scroll-menu .os-viewport").on("scroll",(function(){ce()})),ce())}function ce(){jQuery(".folder-modal #js-tree-menu span.folder-actions").css("right",jQuery(".folder-modal #custom-scroll-menu .horizontal-scroll-menu").width()-jQuery(".folder-modal #custom-scroll-menu .os-viewport").width()-e(".folder-modal #custom-scroll-menu .os-viewport").scrollLeft()-10)}function me(){if(e(".media-toolbar").hasClass("media-toolbar-mode-select")&&e("ul.attachments li.selected").length&&(e("ul.attachments li.selected").trigger("click"),e(".select-mode-toggle-button").trigger("click")),""!=j&&(e("#js-tree-menu a.jstree-clicked").length>0||"-1"==g)){if(e("#media-attachment-taxonomy-filter").length){j=j.split(",");for(var t=0;t<j.length;t++)""!=j[t]&&e(".attachments-browser li[data-id='"+j[t]+"']").remove()}j=""}e("#media-attachment-taxonomy-filter").length?ye(0):(e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=get_folders_default_list",method:"post",success:function(t){t=e.parseJSON(t),e(".header-posts .total-count").text(t.total_items),e(".un-categorised-items .total-count").text(t.empty_items),b=t.taxonomies,_e()}}),e(".folder-loader-ajax").addClass("active"),e("#folder-posts-filter").length?e("#folder-posts-filter").load(v+" #posts-filter",(function(){var t={Title:"",Url:v};history.pushState(t,t.Title,t.Url),"show"!=folders_media_options.show_in_page||e(".tree-structure").length||e(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),ue(),function(){ue(),e(".form-loader-count").css("width","0"),"object"==typeof inlineEditPost&&(inlineEditPost.init(),e("#the-list").on("click",".editinline",(function(){e(this).attr("aria-expanded","true"),inlineEditPost.edit(this)})),e(document).on("click",".inline-edit-save .save",(function(){var t=e(this).closest("tr").attr("id");t=(t=t.replace("edit-","")).replace("post-",""),inlineEditPost.save(t)})),e(document).on("click",".inline-edit-save .cancel",(function(){var t=e(this).closest("tr").attr("id");t=(t=t.replace("edit-","")).replace("post-",""),inlineEditPost.revert(t)})));"attachment"==folders_media_options.post_type&&(e(".move-to-folder-top").length||e("#bulk-action-selector-top").append("<option class='move-to-folder-top' value='move_to_folder'>"+folders_media_options.lang.MOVE_TO_FOLDER+"</option>"),e(".move-to-folder-bottom").length||e("#bulk-action-selector-bottom").append("<option class='move-to-folder-bottom' value='move_to_folder'>"+folders_media_options.lang.MOVE_TO_FOLDER+"</option>"))}()})):e("#wpbody").load(v+" #wpbody-content",!1,(function(t){var o={Title:"",Url:v};history.pushState(o,o.Title,o.Url),"show"!=folders_media_options.show_in_page||e(".tree-structure").length||e(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),ue()})))}function pe(){ue(),le()}function fe(){e("#custome_folder_color_css").remove();var t="<style id='custome_folder_color_css'>";e(l).each((function(e,o){""!=o.has_color&&o.has_color!=folders_media_options.default_color&&(t+="li.jstree-node[id='"+o.folder_id+"'] .pfolder-folder-close {color: "+o.has_color+"!important;}")})),t+="</style>",e("head").append(t)}function ue(){if(l.length){var t=0;e(".folder-modal #js-tree-menu li.jstree-node").each((function(){folderPostId=de(e(this).attr("id")),null!=folderPostId&&(1==l[folderPostId].is_high?e(this).addClass("is-high"):e(this).removeClass("is-high"),1==l[folderPostId].is_locked?(e(this).addClass("is-locked"),t++):e(this).removeClass("is-locked"),1==l[folderPostId].is_sticky?e(this).addClass("is-sticky"):e(this).removeClass("is-sticky"),l[folderPostId].slug==folders_media_options.default_folder?e(this).addClass("is-current"):e(this).removeClass("is-current"))})),fe(),t>0&&t==e("#js-tree-menu li.jstree-node").length?e(".lock-unlock-all-folders").addClass("all-folder-locked").removeClass("open-folders").attr("data-folder-tooltip","Use this to lock a folder's position so it cannot be moved\n\n Click to Unlock all folders"):e(".lock-unlock-all-folders").addClass("open-folders").removeClass("all-folder-locked").attr("data-folder-tooltip","Use this to lock a folder's position so it cannot be moved\n\n Click to Lock all folders")}}function _e(){if(ue(),le(),e("#media-attachment-taxonomy-filter").length&&(e("#media-attachment-taxonomy-filter").each((function(){folders_media_options.terms=b;var t=e(this);currentDDVal=e(this).val(),t.html("<option value='all'>All Folders</option><option value='unassigned'>(Unassigned)</option>"),b;for(var o=0;o<b.length;o++)t.append("<option value='"+b[o].term_id+"'>"+b[o].name+" ("+b[o].trash_count+")</option>");0!=R?(e(".jstree-clicked").removeClass("jstree-clicked"),e("#js-tree-menu").jstree("select_node",R),t.val(R).trigger("change")):t.val(currentDDVal)})),e("select.folder_for_media").length)){var t=e("select.folder_for_media").val();e("select.folder_for_media option:not(:first-child):not(:last-child)").remove();for(var o=0;o<b.length;o++)e("select.folder_for_media option:last-child").before("<option value='"+b[o].term_id+"'>"+b[o].name+"</option>");""!=t&&e(".folder_for_media").val(t)}for(e("span.premio-folder-count").text(""),e(".folder-count").text(""),o=0;o<b.length;o++)0!=parseInt(b[o].trash_count)?(e(".jstree-node[id='"+b[o].term_id+"'] > a.jstree-anchor span.premio-folder-count").text(b[o].trash_count),e(".sticky-folder-"+b[o].term_id+" .premio-folder-count").text(b[o].trash_count)):(e(".jstree-node[id='"+b[o].term_id+"'] > a.jstree-anchor span.premio-folder-count").text(0),e(".sticky-folder-"+b[o].term_id+" .premio-folder-count").text(0));""!=g&&e("#wcp_folder_"+g).addClass("active-item"),y&&(e("#title_"+m).trigger("click"),y=!1),R=0}function he(){var t=e.trim(e("#folder-search").val());e("#js-tree-menu").jstree("search",t)}function ve(t){var o=folders_media_options.lang.DELETE_FOLDER_MESSAGE,s=folders_media_options.lang.ITEM_NOT_DELETED;if(k=!1,1==t&&e("#menu-checkbox").is(":checked")){var a=0;if(e("#js-tree-menu input.checkbox:checked").each((function(){e(this).closest("li.jstree-node").hasClass("is-locked")||a++})),0==a)return;if(k=!0,0==e("#js-tree-menu input.checkbox:checked").length)return e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(folders_media_options.lang.SELECT_AT_LEAST_ONE_FOLDER),void e("#error-folder-popup").show();e("#js-tree-menu input.checkbox:checked").length>1&&(o=folders_media_options.lang.DELETE_FOLDERS_MESSAGE,s=folders_media_options.lang.ITEMS_NOT_DELETED)}e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#remove-folder-item").text(folders_media_options.lang.YES_DELETE_IT),e("#remove-folder-message").text(o),e("#remove-folder-notice").text(s),e("#confirm-remove-folder").show(),e("#remove-folder-item").focus()}function ge(){folderName=e.trim(e("#js-tree-menu").jstree(!0).get_node(m).text),parentID=e("#wcp_folder_"+m).closest("li.jstree-node").data("folder-id"),parentID==t&&(parentID=0),e("#update-folder-data").text(folders_media_options.lang.SUBMIT),e(".folder-form-errors").removeClass("active"),e("#update-folder-item-name").val(folderName),e("#update-folder-item").removeClass("disabled"),e("#update-folder-item").show(),e("#update-folder-item-name").focus(),e(".dynamic-menu").remove()}function je(){if(0==u&&f>=10)return e("#folder-limitation-message").html("You've reached the 10 folder limitation!"),e("#no-more-folder-credit").show(),!1;e("#save-folder-data").text("Submit"),e(".folder-form-errors").removeClass("active"),e("#add-update-folder-name").val(""),C&&(x=m,e("#add-update-folder-name").val(e.trim(e("#js-tree-menu").jstree(!0).get_node(m).text)+" #2"),m=e("#"+m+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?e("#"+m+"_anchor").closest(".jstree-node").parent().parent().attr("id"):0),e("#add-update-folder").removeClass("disabled"),e("#add-update-folder").show(),e("#add-update-folder-name").focus(),e(".dynamic-menu").remove()}function ke(){setTimeout((function(){if(e("#js-tree-menu .jstree-node.jstree-leaf").length==e("#js-tree-menu .jstree-node").length)e("#expand-collapse-list").removeClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip",folders_media_options.lang.EXPAND),e("#expand-collapse-list .text").text(folders_media_options.lang.EXPAND);else{var t=e("#js-tree-menu .jstree-node.jstree-closed").length+e("#js-tree-menu .jstree-node.jstree-open").length;e("#js-tree-menu .jstree-node.jstree-closed").length==t?(e("#expand-collapse-list").removeClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip",folders_media_options.lang.EXPAND),e("#expand-collapse-list .text").text(folders_media_options.lang.EXPAND)):(e("#expand-collapse-list").addClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip",folders_media_options.lang.COLLAPSE),e("#expand-collapse-list .text").text(folders_media_options.lang.COLLAPSE))}}),500),$()}function ye(o){W=e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_get_default_list&active_id="+g,method:"post",beforeSend:function(){null!=W&&W.abort()},success:function(s){if(s=e.parseJSON(s),e(".header-posts .total-count").text(s.total_items),e(".un-categorised-items .total-count").text(s.empty_items),selectedVal=e("#media-attachment-taxonomy-filter").val(),"all"!=selectedVal&&1==o){var a=parent.wp;a.media!=t&&(a.media.frame.setState("insert"),null!==a.media.frame.content.get()&&void 0!==a.media.frame.content.get().collection?(a.media.frame.content.get().collection.props.set({ignore:+new Date}),a.media.frame.content.get().options.selection.reset()):a.media.frame.library.props.set({ignore:+new Date}))}b=s.taxonomies,_e(),$()}})}function Ce(){e(".folder-loader-ajax").addClass("active"),e(".folder-loader-ajax img").removeClass("active"),e(".folder-loader-ajax svg#successAnimation").addClass("active").addClass("animated"),setTimeout((function(){e(".folder-loader-ajax").removeClass("active"),e(".folder-loader-ajax img").addClass("active"),e(".folder-loader-ajax svg#successAnimation").removeClass("active").removeClass("animated")}),2e3),le(),$()}e(document).ready((function(){e(document).on("click","#js-tree-menu input.checkbox",(function(){ae()})),o=parseInt(folders_media_options.hasStars),s=parseInt(folders_media_options.hasChildren),E=parseInt(folders_media_options.hasValidLicense),e(document).on("click",".folder-color-option , .folder-color-default",(function(t){e(".custom-folder-icon-color").spectrum("hide"),t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id");var o=e(this).attr("data-color");void 0===o&&(o="");var s=de(c);l[s].has_color=o,fe(),h=ie(c,"nonce"),e(".dynamic-menu").remove(),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+c+"&type="+folders_media_options.post_type+"&action=wcp_change_color_folder&nonce="+h+"&color="+o,method:"post",cache:!1,success:function(t){t=e.parseJSON(t),fe()}})})),e(document).on("click",".folder-settings-btn > a",(function(t){t.stopPropagation(),e(".folder-settings-btn").toggleClass("active")})),e(document).on("click","body,html",(function(){e(".folder-settings-btn").removeClass("active")})),e(document).on("click",".folder-setting-menu",(function(e){e.stopPropagation()})),e(document).on("click",".lock-unlock-all-folders",(function(){e(this).hasClass("open-folders")?e("#lock-all-folder-popup").show():e("#unlock-all-folder-popup").show()})),e(document).on("click",".lock-all-folder, .unlock-all-folder",(function(t){var o=0;e(this).hasClass("lock-all-folder")&&(o=1),e(".folder-settings-btn").removeClass("active"),e(".form-loader-count").css("width","100%"),t.preventDefault(),e("#unlock-all-folder-popup, #lock-all-folder-popup").hide(),e.ajax({url:folders_media_options.ajax_url,data:{post_type:folders_media_options.post_type,nonce:folders_media_options.nonce,action:"premio_lock_unlock_all_folders",lock_folders:o},method:"post",success:function(t){if(t=e.parseJSON(t),e(".form-loader-count").css("width","0"),Ce(),1==t.status&&l.length>0)for(var o=0;o<l.length;o++)l[o].is_locked=t.data.is_locked;pe()}})})),e(document).on("change","#upload_media_folder",(function(){var t=new FormData;if(e("#upload_media_folder")[0].files.length){for(var o=0;o<e("#upload_media_folder")[0].files.length;o++)t.append("media_files_"+o,e("#upload_media_folder")[0].files[o]),t.append("media_file_name["+o+"]",e("#upload_media_folder")[0].files[o].webkitRelativePath);t.append("post_type",folders_media_options.post_type),t.append("nonce",folders_media_options.nonce),t.append("action","upload_premio_folder"),e(".form-loader-count").css("width","100%"),e.ajax({url:folders_media_options.ajax_url,type:"post",data:t,contentType:!1,processData:!1,success:function(t){if(1==(t=e.parseJSON(t)).status){var o=0;if(t.data.length>0)for(var s=0;s<t.data.length;s++){var a={folder_id:t.data[s].term_id,folder_count:0,is_sticky:t.data[s].is_sticky,is_high:t.data[s].is_high,is_locked:t.data[s].is_locked,has_color:t.data[s].has_color,nonce:t.data[s].nonce,slug:t.data[s].slug,is_deleted:0};0==o&&(o=t.data[s].term_id),l.push(a);var r=t.data[s].title;r=r.replace(/\\/g,""),e("#js-tree-menu").jstree().create_node(t.data[s].parent_id,{id:t.data[s].term_id,text:" "+r},"last",(function(){e(".jstree-node[id='"+t.data[s].term_id+"']").attr("data-nonce",t.data[s].nonce),e(".jstree-node[id='"+t.data[s].term_id+"']").attr("data-slug",t.data[s].slug)}))}0!=o&&(R=o),e(".form-loader-count").css("width","0px"),Ce(),e("#media-attachment-taxonomy-filter").length&&ye(0),e("#upload_media_folder").val("")}}})}})),e(document).on("click",".close-popup-button",(function(t){e(".folder-popup-form").hide(),e(".folder-modal .jstree-node[id='"+m+"']").length&&e(".folder-modal .jstree-node[id='"+m+"'] > a.jstree-anchor").trigger("focus")})),e(document).on("click",".thumbnail-hover-box a",(function(t){return t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),window.open(e(this).prop("href"),"_blank"),!1})),e(document).ajaxComplete((function(e,t,o){})),b=folders_media_options.terms,u=parseInt(folders_media_options.is_key_active),f=parseInt(folders_media_options.folders),l=folders_media_options.folder_settings,e(document).on("click",".header-posts a.all-posts",(function(t){m=0,g="",n="all",e(".active-item").removeClass("active-item"),e(".jstree-clicked").removeClass("jstree-clicked"),e(this).addClass("active-item"),e(".sticky-folders .active-item").removeClass("active-item"),e(this).closest(".media-frame").find("#media-attachment-taxonomy-filter").val("all").trigger("change"),e(this).closest(".media-frame").find(".folder_for_media").val("all").trigger("change"),ae()})),e(document).on("click",".un-categorised-items",(function(t){m=0,g="",n="unassigned",e(".active-item").removeClass("active-item"),e(".sticky-folders .active-item").removeClass("active-item"),e(".jstree-clicked").removeClass("jstree-clicked"),e(this).addClass("active-item"),e(this).closest(".media-frame").find("#media-attachment-taxonomy-filter").val("unassigned").trigger("change"),e(this).closest(".media-frame").find(".folder_for_media").val("-1").trigger("change"),ae()})),e(document).on("click","#js-tree-menu a.jstree-anchor",(function(t){e("#dynamic-tree-folders .jstree-clicked").removeClass("jstree-clicked"),e("#media-attachment-dynamic-filter").val("dynamic-folders");var o=e(this).closest("li.jstree-node").attr("id");n=m=o,e(this).closest(".folder-modal").find(".active-item").removeClass("active-item"),e(this).closest(".folder-modal").find("#media-attachment-taxonomy-filter").val(o),e(this).closest(".folder-modal").find("#media-attachment-taxonomy-filter").trigger("change"),thisSlug=ie(o,"slug"),function(t){e.ajax({url:folders_media_options.ajax_url,type:"post",data:"action=save_folder_last_status&post_type="+folders_media_options.post_type+"&post_id="+t+"&nonce="+folders_media_options.nonce,cache:!1,async:!1,success:function(){}})}(thisSlug),e(".custom-media-select").removeClass("active"),ae()})),e(document).on("click","#dynamic-tree-folders a.jstree-anchor",(function(t){e("#media-attachment-taxonomy-filter").val("all"),m="",n="",e(".active-item").removeClass("active-item"),e(".sticky-folders .active-item").removeClass("active-item"),e("#js-tree-menu .jstree-clicked").removeClass("jstree-clicked");var o=e(this).closest("li.jstree-node").attr("id");e("#media-attachment-dynamic-filter").val(o).trigger("change"),ae()})),e(document).on("change",".folder_for_media",(function(){"add-folder"!=e(this).val()&&null!=e(this).val()?n=e(this).val():"add-folder"==e(this).val()&&(n=-1)})),e(document).on("change","#media-attachment-dynamic-filter",(function(){"dynamic-folders"!=e(this).val()&&e("#media-attachment-taxonomy-filter").val("all")})),e(document).on("change","#media-attachment-taxonomy-filter",(function(){"all"!=e(this).val()&&e("#media-attachment-dynamic-filter").val("dynamic-folders")})),e(document).on("click","body, html",(function(t){e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e(".folder-order").removeClass("active")})),e(document).on("click",".dynamic-menu, .folder-order",(function(e){e.stopPropagation()})),"admin"!=F&&"view-edit"!=F||(e(document).on("contextmenu",".js-tree-data .jstree-anchor",(function(t){return I=t.pageX,S=t.pageY,e(this).find("span.folder-inline-edit").trigger("click"),!1})),e(document).on("click",".folder-actions span.folder-inline-edit",(function(a){if(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault(),0!=folders_media_options.can_manage_folder){isHigh=e(this).closest("li.jstree-node").hasClass("is-high"),isLocked=e(this).closest("li.jstree-node").hasClass("is-locked"),isSticky=e(this).closest("li.jstree-node").hasClass("is-sticky"),isDefault=e(this).closest("li.jstree-node").hasClass("is-current");var r,i=e(this).closest("li").prop("id");if(isStickyClass=!!isSticky,e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(E?"":"no-key")+"' data-id='"+e(this).closest("li").prop("id")+"'><ul>","admin"==F&&(menuHtml+=E||s?"<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>"+folders_media_options.lang.NEW_SUB_FOLDER+"</a></li>":"<li class='new-folder-pro'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>"+folders_media_options.lang.ACTIVATE.NEW_SUB_FOLDER+"</a></li>"),menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>"+folders_media_options.lang.RENAME+"</a></li>",menuHtml+="<li class='color-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>"+folders_media_options.lang.CHANGE_COLOR+"<span class='dashicons dashicons-arrow-right-alt2'></span></a>",menuHtml+="<ul class='color-selector'>",menuHtml+="<li class='color-selector-ul'>",e(folders_media_options.selected_colors).each((function(e,t){menuHtml+="<span class='folder-color-option' data-color='"+t+"' style='background-color:"+t+"'></span>"})),parseInt(folders_media_options.hasValidLicense)&&(menuHtml+="<span><input type='text' class='custom-folder-icon-color' /></span>"),menuHtml+="</li>",parseInt(folders_media_options.hasValidLicense)||(menuHtml+="<li><a href='"+folders_media_options.register_url+"' target='_blank' class='folder-color-default'>"+folders_media_options.lang.ACTIVATE_COLOR_KEY+"</a></li>"),menuHtml+="<li><a href='javascript:;' class='folder-color-default'>"+folders_media_options.lang.REMOVE_COLOR+"</a></li>",menuHtml+="</ul>",menuHtml+="</li>",menuHtml+=E?"<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?folders_media_options.lang.REMOVE_STICKY_FOLDER:folders_media_options.lang.STICKY_FOLDER)+"</a></li>":"<li class='sticky-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+folders_media_options.lang.ACTIVATE.STICKY_FOLDER+"</a></li>",menuHtml+=E||o?"<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?folders_media_options.lang.REMOVE_STAR:folders_media_options.lang.ADD_STAR)+"</a></li>":"<li class='mark-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?folders_media_options.lang.ACTIVATE.REMOVE_STAR:folders_media_options.lang.ACTIVATE.ADD_STAR)+"</a></li>",E?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?folders_media_options.lang.UNLOCK_FOLDER:folders_media_options.lang.LOCK_FOLDER)+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>"+folders_media_options.lang.DUPLICATE_FOLDER+"</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='dashicons dashicons-lock'></span>"+folders_media_options.lang.ACTIVATE.LOCK_FOLDER+"</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-clone'></i></span>"+folders_media_options.lang.ACTIVATE.DUPLICATE_FOLDER+"</a></li>"),hasPosts=parseInt(e(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),hasPosts&&(menuHtml+=E?"<li target='_blank' class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>"+folders_media_options.lang.DOWNLOAD_ZIP+"</a></li>":"<li target='_blank' class='download-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>"+folders_media_options.lang.ACTIVATE.DOWNLOAD_ZIP+"</a></li>"),isDefault?menuHtml+="<li class='remove-default-folder'><a href='javascript:;'><span><i class='pfolder-active-icon'></i></span>"+folders_media_options.lang.REMOVE_THIS_FOLDER+"</a></li>":menuHtml+="<li class='default-folders'><a href='javascript:;'><span><i class='pfolder-active-icon'></i></span>"+folders_media_options.lang.OPEN_THIS_FOLDER+"</a></li>",menuHtml+="<li class='cut-folders'><a href='javascript:;'><span><i class='pfolder-cut'></i></span>"+folders_media_options.lang.CUT+"</a></li>",menuHtml+="<li class='copy-folders'><a href='javascript:;'><span><i class='pfolder-copy'></i></span>"+folders_media_options.lang.COPY+"</a></li>",O&&(menuHtml+="<li class='paste-folders'><a href='javascript:;'><span><i class='pfolder-paste'></i></span>"+folders_media_options.lang.PASTE+"</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>"+folders_media_options.lang.DELETE+"</a></li></ul></div>",e("body").append(menuHtml),a.pageX!==t&&a.pageY!=t?(e(".dynamic-menu").css("left",a.pageX),e(".dynamic-menu").css("top",a.pageY),r=a.pageY):e(this).offset().top!==t&&e(this).offset().left!=t?(e(".dynamic-menu").css("left",e(this).offset().left),e(".dynamic-menu").css("top",e(this).offset().top),r=e(this).offset().top):(e(".dynamic-menu").css("left",I),e(".dynamic-menu").css("top",S-10),r=S),r+e(".dynamic-menu").height()>e(window).height()&&e(".dynamic-menu").css("margin-top",e(window).height()-(r+e(".dynamic-menu").height())),e(this).parents("li.jstree-node").addClass("active-menu"),e(".custom-folder-icon-color").length){var d=de(i);T=""==l[d].has_color?folders_media_options.default_color:l[d].has_color,e(".custom-folder-icon-color").spectrum({chooseText:"Submit",preferredFormat:"hex",showInput:!0,appendTo:e(".color-selector-ul"),cancelText:"Cancel",color:T,show:function(e){H=!1},hide:function(t){if(c=e(this).closest(".dynamic-menu").data("id"),!H&&T){var o=de(c);l[o].has_color=T,fe()}else{var s=t.toHexString();void 0===s&&(s="");o=de(c);l[o].has_color=s,fe(),h=ie(c,"nonce"),D=e.ajax({url:folders_media_options.ajax_url,data:{term_id:c,type:folders_media_options.post_type,action:"wcp_change_color_folder",nonce:h,color:s},beforeSend:function(){null!==D&&D.abort()},method:"post",cache:!1,success:function(t){t=e.parseJSON(t),fe()}})}e(".dynamic-menu").remove()},change:function(t){H=!0;var o=t.toHexString();void 0===o&&(o="");var s=de(c);l[s].has_color=o,fe(),h=ie(c,"nonce"),D=e.ajax({url:folders_media_options.ajax_url,data:{term_id:c,type:folders_media_options.post_type,action:"wcp_change_color_folder",nonce:h,color:o},beforeSend:function(){null!==D&&D.abort()},method:"post",cache:!1,success:function(t){t=e.parseJSON(t),fe()}})},move:function(t){c=e(this).closest(".dynamic-menu").data("id");var o=t.toHexString();void 0===o&&(o="");var s=de(c);l[s].has_color=o,fe()}})}return!1}}))),e(document).on("click",".dynamic-menu",(function(e){e.stopImmediatePropagation(),e.stopPropagation()})),e(document).on("click","body, html",(function(){e(".dynamic-menu").remove()})),e(document).on("click",".new-folder-pro",(function(t){e(".dynamic-menu").remove(),e("#sub-folder-popup").show()})),e(document).on("change","#media-attachment-taxonomy-filter",(function(t){e("#js-tree-menu").hasClass("jstree-default")&&e("#js-tree-menu").jstree(!0).deselect_all(),e("#dynamic-folders").length&&e("#dynamic-folders").hasClass("jstree-default")&&e("#dynamic-folders").jstree(!0).deselect_all(),e(".active-item").removeClass("active-item"),"all"==e(this).val()?e(".all-posts").addClass("active-item"):"unassigned"==e(this).val()?e(".un-categorised-items").addClass("active-item"):(e("#js-tree-menu").jstree("select_node",e(this).val()),e(".sticky-folder-"+e(this).val()+" a").addClass("active-item"))})),e(document).on("click",".new-folder",(function(t){t.stopPropagation(),m=e(this).closest(".dynamic-menu").data("id"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),y=!1,C=!1,e("#add-update-folder-title").text(folders_media_options.lang.ADD_NEW_FOLDER),je()})),e(document).on("click","#add-new-folder",(function(t){m=e("#custom-menu li.active-item").length?e("#custom-menu li.active-item").data("folder-id"):0,y=!1,C=!1,e("#add-update-folder-title").text(folders_media_options.lang.ADD_NEW_FOLDER),je()})),e(document).on("submit","#save-folder-form",(function(t){if(t.stopPropagation(),t.preventDefault(),p=e("#add-update-folder-name").val(),""==e.trim(p))e(".folder-form-errors").addClass("active"),e("#add-update-folder-name").focus();else{e("#save-folder-data").html('<span class="dashicons dashicons-update"></span>'),e("#add-update-folder").addClass("disabled");var o=m;y&&(o=0),w=0==o?e("#js-tree-menu > ul > li.jstree-node").length:e("#js-tree-menu > ul > li.jstree-node[id='"+o+"'] > ul.jstree-children > li").length+1;var s=[];0==o?e("#js-tree-menu > .jstree-container-ul > .jstree-node").length&&e("#js-tree-menu > .jstree-container-ul > .jstree-node").each((function(){s.push(e(this).attr("id"))})):e("#js-tree-menu .jstree-node[id='"+o+"'] > ul> li.jstree-node").length&&e("#js-tree-menu .jstree-node[id='"+o+"'] > ul> li.jstree-node").each((function(){s.push(e(this).attr("id"))})),e.ajax({url:folders_media_options.ajax_url,data:{parent_id:o,type:folders_media_options.post_type,action:"wcp_add_new_folder",nonce:folders_media_options.nonce,term_id:o,order:w,name:p,folders:s,is_duplicate:C,duplicate_from:x},method:"post",success:function(t){if(result=e.parseJSON(t),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),-1==result.status)e("#no-more-folder-credit").show();else if("1"==result.status){if(u=parseInt(result.is_key_active),f=parseInt(result.folders),e("#current-folder").text(f),e("#ttl-fldr").text(10),ke(),result.data.length)for(var o=0;o<result.data.length;o++){var s={folder_id:result.data[o].term_id,folder_count:result.data[o].folder_count,is_sticky:result.data[o].is_sticky,is_high:result.data[o].is_high,is_locked:result.data[o].is_locked,has_color:result.data[o].has_color,nonce:result.data[o].nonce,slug:result.data[o].slug,is_deleted:0},a=result.data[o].title;a=a.replace(/\\/g,""),l.push(s),e("#js-tree-menu").jstree().create_node(result.parent_id,{id:result.data[o].term_id,text:" "+a},o,(function(){e(".jstree-node[id='"+result.data[o].term_id+"']").attr("data-nonce",result.data[o].nonce),e(".jstree-node[id='"+result.data[o].term_id+"']").attr("data-slug",result.data[o].slug),e(".jstree-node[id='"+result.data[o].term_id+"']").attr("data-parent",result.parent_id),e(".jstree-node[id='"+result.data[o].term_id+"'] > a.jstree-anchor .premio-folder-count").text(result.data[o].folder_count)})),e(".folder-modal .jstree-node[id='"+result.parent_id+"']").length&&e(".folder-modal #js-tree-menu").jstree("open_node",e("#"+result.parent_id)),e(".folder-modal .jstree-node[id='"+result.parent_id+"']").length?e(".folder-modal .jstree-node[id='"+result.parent_id+"'] > a.jstree-anchor").trigger("focus"):e(".folder-modal .jstree-node[id='"+result.data[o].term_id+"']").length&&e(".folder-modal .jstree-node[id='"+result.data[o].term_id+"'] > a.jstree-anchor").trigger("focus")}Ce(),pe(),m=result.term_id,ye(0),C&&me(),C=!1,x=0}else e("#error-folder-popup-message").html(result.message),e("#error-folder-popup").show()}})}return!1})),e(document).on("click",".form-cancel-btn",(function(){e(".folder-popup-form").hide(),e(".jstree-node[id='"+m+"']").length?e(".jstree-node[id='"+m+"'] > a.jstree-anchor").trigger("focus"):e("#js-tree-menu .jstree-anchor.jstree-clicked").length&&e("#js-tree-menu .jstree-anchor.jstree-clicked").trigger("focus")})),e(document).on("click",".folder-popup-form",(function(t){e(".folder-popup-form").hide(),e(".jstree-node[id='"+m+"']").length?e(".jstree-node[id='"+m+"'] > a.jstree-anchor").trigger("focus"):e("#js-tree-menu .jstree-anchor.jstree-clicked").length&&e("#js-tree-menu .jstree-anchor.jstree-clicked").trigger("focus")})),e(document).on("click",".popup-form-content",(function(e){e.stopPropagation()})),document.onkeydown=function(t){("key"in(t=t||window.event)?"Escape"===t.key||"Esc"===t.key:27===t.keyCode)&&e(".folder-popup-form").hide()},e(document).on("click",".rename-folder",(function(t){t.stopPropagation(),m=e(this).closest(".dynamic-menu").data("id"),ge(),e(".dynamic-menu").remove()})),e(document).on("click","#inline-update",(function(t){e("#js-tree-menu a.jstree-clicked").length&&(m=e("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),ge())})),e(document).on("submit","#update-folder-form",(function(o){return o.stopPropagation(),o.preventDefault(),p=e("#update-folder-item-name").val(),""==e.trim(p)?(e(".folder-form-errors").addClass("active"),e("#update-folder-item-name").focus()):(e("#update-folder-data").html('<span class="dashicons dashicons-update"></span>'),e("#update-folder-item").addClass("disabled"),h=ie(m,"nonce"),parentID=e(".jstree-node[id='"+m+"']").closest("li.jstree-node").attr("id"),parentID==t&&(parentID=0),e.ajax({url:folders_media_options.ajax_url,data:{parent_id:parentID,type:folders_media_options.post_type,action:"wcp_update_folder",nonce:h,term_id:m,order:w,name:p},method:"post",success:function(t){result=e.parseJSON(t),"1"==result.status?(e("#js-tree-menu").jstree("rename_node",result.id," "+result.term_title),e(".sticky-folder-"+result.id+" .folder-title").html(result.term_title),folderPostId=de(result.id),null!=folderPostId&&(l[folderPostId].nonce=result.nonce,l[folderPostId].slug=result.slug),e(".folder-popup-form").hide(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),Ce(),e("#media-attachment-taxonomy-filter").length&&ye(0)):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(result.message),e("#error-folder-popup").show())}})),!1})),e(document).on("click",".mark-folder",(function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id"),h=ie(c,"nonce"),e(".form-loader-count").css("width","100%"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+c+"&type="+folders_media_options.post_type+"&action=wcp_mark_un_mark_folder&nonce="+h,method:"post",cache:!1,success:function(t){t=e.parseJSON(t),e(".form-loader-count").css("width","0%"),"1"==t.status?(folderPostId=de(t.id),"1"==t.marked?(e("li.jstree-node[id='"+t.id+"']").addClass("is-high"),e(".sticky-folder-"+t.id).addClass("is-high"),null!=folderPostId&&(l[folderPostId].is_high=1)):(e("li.jstree-node[id='"+t.id+"']").removeClass("is-high"),e(".sticky-folder-"+t.id).removeClass("is-high"),null!=folderPostId&&(l[folderPostId].is_high=0)),Ce(),e(".folder-modal .jstree-node[id='"+t.id+"']").length&&e(".folder-modal .jstree-node[id='"+t.id+"'] > a.jstree-anchor").trigger("focus")):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})})),e(document).on("click",".lock-folder",(function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id"),h=ie(c,"nonce"),e(".form-loader-count").css("width","100%"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+c+"&type="+folders_media_options.post_type+"&action=wcp_lock_unlock_folder&nonce="+h,method:"post",cache:!1,success:function(t){t=e.parseJSON(t),e(".form-loader-count").css("width","0%"),"1"==t.status?(folderPostId=de(t.id),"1"==t.marked?(e("li.jstree-node[id='"+t.id+"']").addClass("is-locked"),e(".sticky-folder-"+t.id).addClass("is-locked"),null!=folderPostId&&(l[folderPostId].is_locked=1)):(e("li.jstree-node[id='"+t.id+"']").removeClass("is-locked"),e(".sticky-folder-"+t.id).removeClass("is-locked"),null!=folderPostId&&(l[folderPostId].is_locked=0)),Ce(),e(".folder-modal .jstree-node[id='"+t.id+"']").length&&e(".folder-modal .jstree-node[id='"+t.id+"'] > a.jstree-anchor").trigger("focus")):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})})),e(document).on("click",".duplicate-folder",(function(t){t.stopPropagation(),m=e(this).closest(".dynamic-menu").data("id"),e(".dynamic-menu").remove(),y=!1,C=!0,e("#add-update-folder-title").text(folders_media_options.lang.DUPLICATING_FOLDER),je()})),e(document).on("click",".remove-folder",(function(){e(this).closest(".dynamic-menu").hasClass("is-locked")||(c=e(this).closest(".dynamic-menu").data("id"),m=e(this).closest(".dynamic-menu").data("id"),ve(0),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"))})),e(document).on("click","#remove-folder-item",(function(t){t.stopPropagation(),e(".folder-popup-form").addClass("disabled"),e("#remove-folder-item").html('<span class="dashicons dashicons-update"></span>'),h=ie(m,"nonce"),k?function(){if(e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0){var t="";e("#js-tree-menu input.checkbox:checked").each((function(){t+=e(this).closest("li.jstree-node").attr("id")+",",e(this).closest("li.jstree-node").hasClass("jstree-clicked")&&!0})),e(".form-loader-count").css("width","100%"),e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_remove_muliple_folder&term_id="+t+"&nonce="+folders_media_options.nonce,method:"post",success:function(t){if(t=e.parseJSON(t),e(".form-loader-count").css("width","0px"),"1"==t.status){for(u=parseInt(t.is_key_active),f=parseInt(t.folders),e("#current-folder").text(f),i=0;i<t.term_ids.length;i++)e(".folder-modal #js-tree-menu").jstree().delete_node(t.term_ids[i]);e("#ttl-fldr").text(10),Ce(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),me(),le(),Ce(),e(".folder-modal #wcp_folder_"+g).length||(e(".header-posts a").trigger("click"),g=0)}else window.location.reload();e("#menu-checkbox").attr("checked",!1),e("#js-tree-menu input.checkbox").attr("checked",!1),e("#js-tree-menu").removeClass("show-folder-checkbox")}})}}():e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_remove_folder&term_id="+m+"&nonce="+h,method:"post",success:function(t){if("1"==(t=e.parseJSON(t)).status){var o=function(t){if(e(".jstree-node[id='"+t+"']").next().length)return e(".jstree-node[id='"+t+"']").next().attr("id");if(e(".jstree-node[id='"+t+"']").prev().length)return e(".jstree-node[id='"+t+"']").prev().attr("id");if(e(".jstree-node[id='"+t+"']").parent().parent().hasClass("jstree-node"))return e(".jstree-node[id='"+t+"']").parent().parent().attr("id");return 0}(m);e("#js-tree-menu").jstree().delete_node(m),u=parseInt(t.is_key_active),f=parseInt(t.folders),e("#current-folder").text(f),e("#ttl-fldr").text(10),e(".sticky-folders .sticky-folder-"+m).remove(),Ce(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),me(),le(),0!=o&&e(".folder-modal #"+o+"_anchor").length?e(".folder-modal #"+o+"_anchor").trigger("click").focus():e(".header-posts").trigger("click")}else e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show()}})})),e(document).on("click","#sort-order-list",(function(t){t.stopPropagation(),e(".folder-order").toggleClass("active")})),e(document).on("click","#expand-collapse-list",(function(t){t.stopPropagation();var o=0;e(this).hasClass("all-open")?(e(this).removeClass("all-open"),o=0,e(this).attr("data-folder-tooltip",folders_media_options.lang.EXPAND),e("#expand-collapse-list .text").text(folders_media_options.lang.EXPAND),e("#js-tree-menu").jstree("close_all")):(e(this).addClass("all-open"),o=1,e(this).attr("data-folder-tooltip",folders_media_options.lang.COLLAPSE),e("#expand-collapse-list .text").text(folders_media_options.lang.COLLAPSE),e("#js-tree-menu").jstree("open_all")),j="",e("#js-tree-menu .jstree-node:not(.jstree-leaf)").each((function(){j+=e(this).attr("id")+","})),""!=j&&(e(".form-loader-count").css("width","100%"),h=folders_media_options.nonce,e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_change_all_status&status="+o+"&folders="+j+"&nonce="+h,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status&&(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show(),window.location.reload(!0))}}))})),e(document).on("click",".folder-sort-menu a",(function(t){t.stopPropagation(),t.preventDefault(),e(".form-loader-count").css("width","100%"),e(".folder-order").removeClass("active"),e(this).attr("data-sort"),e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_folders_by_order&nonce="+folders_media_options.nonce+"&order="+e(this).attr("data-sort"),method:"post",success:function(t){1==(t=e.parseJSON(t)).status&&(e("#js-tree-menu").jstree().destroy(),e("#js-tree-menu").append("<ul></ul>"),e("#js-tree-menu ul").html(t.data),b=t.terms,_e(),ee()),e(".form-loader-count").css("width","0"),ue()}})})),e(document).on("click",".jstree-node .jstree-icon",(function(){c=e(this).closest("li.jstree-node").attr("id"),e("li.jstree-node[id='"+c+"']").hasClass("jstree-open")?folderStatus=1:folderStatus=0,e(".form-loader-count").css("width","100%"),h=ie(c,"nonce"),ke(),e.ajax({url:folders_media_options.ajax_url,data:"is_active="+folderStatus+"&action=save_wcp_folder_state&term_id="+c+"&nonce="+h,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status||(e("#wcp_folder_"+c).hasClass("active")?(e("#wcp_folder_"+c).removeClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):(e("#wcp_folder_"+c).addClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),Ce()),e("span.premio-folder-count").each((function(){""==e(this).text()&&e(this).text(0)}))}})})),e(document).on("click",".dynamic-tree-data .jstree-node .jstree-icon",(function(){c=e(this).closest("li.jstree-node").attr("id"),e("li.jstree-node[id='"+c+"']").hasClass("jstree-open")?folderStatus=1:folderStatus=0,e(".form-loader-count").css("width","100%"),h=ie(c,"nonce"),ke(),e.ajax({url:folders_media_options.ajax_url,data:{is_active:folderStatus,action:"save_wcp_dynamic_folder_state",term_id:c,nonce:folders_media_options.nonce,post_type:folders_media_options.post_type},method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status||(e("#wcp_folder_"+c).hasClass("active")?(e("#wcp_folder_"+c).removeClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):(e("#wcp_folder_"+c).addClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),Ce())}}),pe()})),e(document).on("keyup","#folder-search",(function(){he()})),e(document).on("change","#folder-search",(function(){he()})),e(document).on("blur","#folder-search",(function(){he()})),e(document).on("click","#menu-checkbox",(function(){e(this).is(":checked")?(e(".js-tree-data").addClass("show-folder-checkbox"),e("#menu-checkbox").prop("checked",!0)):(e(".js-tree-data input.checkbox").attr("checked",!1),e(".js-tree-data").removeClass("show-folder-checkbox"),e("#menu-checkbox").prop("checked",!1))})),e(document).on("click","#menu-checkbox",(function(){e(this).is(":checked")?(e("#menu-checkbox").prop("checked",!0),e(".js-tree-data").addClass("show-folder-checkbox")):(e("#menu-checkbox").prop("checked",!1),e(".js-tree-data input.checkbox").attr("checked",!1),e(".js-tree-data").removeClass("show-folder-checkbox"))})),e(document).on("click",".folder-checkbox, .input-checkbox",(function(e){e.stopImmediatePropagation(),e.stopPropagation()})),e(document).on("click",".jstree-node .jstree-icon",(function(t){c=e(this).closest("li.jstree-node").attr("id"),e("li.jstree-node[id='"+c+"']").hasClass("jstree-open")?folderStatus=0:folderStatus=1,e(".form-loader-count").css("width","100%"),h=ie(c,"nonce"),ke(),e.ajax({url:folders_media_options.ajax_url,data:"is_active="+folderStatus+"&action=save_wcp_folder_state&term_id="+c+"&nonce="+h,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status||(e("#wcp_folder_"+c).hasClass("active")?(e("#wcp_folder_"+c).removeClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):(e("#wcp_folder_"+c).addClass("active"),e("#wcp_folder_"+c).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),Ce())}})})),e(document).on("click","#inline-remove, .delete-folder-action:not(.disabled)",(function(){e("#menu-checkbox").is(":checked")?(e(".dynamic-menu").remove(),ve(1)):e("#js-tree-menu a.jstree-clicked").length&&(e("#js-tree-menu a.jstree-clicked").closest(".jstree-node").hasClass("is-locked")||(m=e("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),ve(1),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu")))})),e(document).on("click","#js-tree-menu input.checkbox",(function(){ae()})),e(document).on("click",".sticky-folder",(function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id");var o=0;folderPostId=de(c),e("li.jstree-node[id='"+c+"']").hasClass("is-sticky")?(e("li.jstree-node[id='"+c+"']").removeClass("is-sticky"),e(".sticky-folders .sticky-folder-"+m).remove(),null!=folderPostId&&(l[folderPostId].is_sticky=0)):(o=1,e("li.jstree-node[id='"+c+"']").addClass("is-sticky"),null!=folderPostId&&(l[folderPostId].is_sticky=1)),e(".dynamic-menu").hide(),h=ie(c,"nonce"),le(),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+c+"&type="+folders_media_options.post_type+"&action=wcp_make_sticky_folder&nonce="+h+"&status="+o,method:"post",cache:!1,success:function(t){"1"==(t=e.parseJSON(t)).status&&e(".media-modal .jstree-node[id='"+t.id+"']").length&&e(".media-modal .jstree-node[id='"+t.id+"'] > a.jstree-anchor").trigger("focus")}})})),e(document).on("click",".download-folder",(function(t){c=e(this).closest(".dynamic-menu").data("id"),e(".folder-download-loading").show(),e(".dynamic-menu").hide(),e.ajax({data:{folder_id:c,nonce:ie(c,"nonce"),action:"download_folders_data"},method:"post",url:folders_media_options.ajax_url,success:function(t){var o,s;e(".folder-download-loading").hide(),(t=e.parseJSON(t)).status?(o=t.file_url,s=t.file_name,fetch(o).then((e=>e.blob())).then((e=>{const t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=s,t.click()})).catch(console.error)):alert(t.message)}})})),e(document).on("click",".sticky-folders > ul > li > a",(function(t){t.stopPropagation();var o=e(this).closest("li").data("folder-id");e(".jstree-node[id='"+o+"']").length&&(e(".jstree-clicked").removeClass("jstree-clicked"),e(".active-item").removeClass("active-item"),e("#js-tree-menu").jstree("select_node",g),e(".jstree-node[id='"+o+"'] > a.jstree-anchor").trigger("click"),e(".jstree-node[id='"+o+"'] > a.jstree-anchor").addClass("jstree-clicked"),e(".sticky-folders .sticky-folder-"+o+" a").addClass("active-item"),ae())})),"admin"!=F&&"view-edit"!=F||(e(document).on("contextmenu",".sticky-fldr >  a",(function(t){return t.stopPropagation(),I=t.pageX,S=t.pageY,e(this).find("span.update-inline-record").trigger("click"),!1})),e(document).on("click",".update-inline-record",(function(a){var r;(a.stopImmediatePropagation(),a.stopPropagation(),0!=folders_media_options.can_manage_folder)&&(isHigh=e(this).closest("li.sticky-fldr").hasClass("is-high"),isLocked=e(this).closest("li.sticky-fldr").hasClass("is-locked"),isSticky=e(this).closest("li.sticky-fldr").hasClass("is-sticky"),isStickyClass=!!isSticky,e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(E?"no-key":"")+" ' data-id='"+e(this).closest("li").data("folder-id")+"'><ul>",menuHtml+=E||s?"<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>"+folders_media_options.lang.NEW_SUB_FOLDER+"</a></li>":"<li class='new-folder-pro'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>"+folders_media_options.lang.ACTIVATE.NEW_SUB_FOLDER+"</a></li>",menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>"+folders_media_options.lang.RENAME+"</a></li>",menuHtml+=E?"<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?folders_media_options.lang.REMOVE_STICKY_FOLDER:folders_media_options.lang.STICKY_FOLDER)+"</a></li>":"<li class='sticky-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+folders_media_options.lang.ACTIVATE.STICKY_FOLDER+"</a></li>",menuHtml+=E||o?"<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?folders_media_options.lang.REMOVE_STAR:folders_media_options.lang.ADD_STAR)+"</a></li>":"<li class='mark-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?folders_media_options.lang.ACTIVATE.REMOVE_STAR:folders_media_options.lang.ACTIVATE.ADD_STAR)+"</a></li>",E?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?folders_media_options.lang.UNLOCK_FOLDER:folders_media_options.lang.LOCK_FOLDER)+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>"+folders_media_options.lang.DUPLICATE_FOLDER+"</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='dashicons dashicons-lock'></span>"+folders_media_options.lang.ACTIVATE.LOCK_FOLDER+"</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-clone'></i></span>"+folders_media_options.lang.ACTIVATE.DUPLICATE_FOLDER+"</a></li>"),hasPosts=parseInt(e(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),hasPosts&&(menuHtml+=E?"<li target='_blank' class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>"+folders_media_options.lang.DOWNLOAD_ZIP+"</a></li>":"<li target='_blank' class='download-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>"+folders_media_options.lang.ACTIVATE.DOWNLOAD_ZIP+"</a></li>"),menuHtml+="<li class='cut-folders'><a href='javascript:;'><span><i class='pfolder-cut'></i></span>"+folders_media_options.lang.CUT+"</a></li>",menuHtml+="<li class='copy-folders'><a href='javascript:;'><span><i class='pfolder-copy'></i></span>"+folders_media_options.lang.COPY+"</a></li>",O&&(menuHtml+="<li class='paste-folders'><a href='javascript:;'><span><i class='pfolder-paste'></i></span>"+folders_media_options.lang.PASTE+"</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>"+folders_media_options.lang.DELETE+"</a></li></ul></div>",e("body").append(menuHtml),a.pageX!==t&&a.pageY!=t?(e(".dynamic-menu").css("left",a.pageX),e(".dynamic-menu").css("top",a.pageY),r=a.pageY):e(this).offset().top!==t&&e(this).offset().left!=t?(e(".dynamic-menu").css("left",e(this).offset().left),e(".dynamic-menu").css("top",e(this).offset().top),r=e(this).offset().top):(e(".dynamic-menu").css("left",I),e(".dynamic-menu").css("top",S-10),r=S),r+e(".dynamic-menu").height()>e(window).height()&&e(".dynamic-menu").css("margin-top",e(window).height()-(r+e(".dynamic-menu").height())))}))),e(document).on("change",".folder_for_media",(function(){"add-folder"==e(this).val()&&(y=!0,e("#add-new-folder").trigger("click"))})),e(document).on("click","#custom-menu .ui-icon, #custom-menu h3",(function(){e("#custom-menu .active-item").removeClass("active-item"),e(this).closest(".route").addClass("active-item")})),e(document).on("click",".media-menu button.media-menu-item, .media-button-insert",(function(){ne()})),e(document).on("click",".undo-button, .undo-folder-action:not(.disabled)",(function(){e(".folders-undo-notification").removeClass("active"),e(this).hasClass("copy-paste-action")?0==N&&0==d||("cut"==A?(0==L&&(L=""),e("#js-tree-menu").jstree("move_node","#"+d,"#"+a,r),0,L=0,d=0,r=0):0!=N&&(h=ie(m=N,"nonce"),e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_remove_folder&term_id="+m+"&nonce="+h,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(e("#js-tree-menu").jstree().delete_node(m),u=parseInt(t.is_key_active),f=parseInt(t.folders),e("#current-folder").text(f),e("#ttl-fldr").text(10),e(".sticky-folders .sticky-folder-"+m).remove(),Ce(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),me(),le(),g==m&&e(".header-posts").trigger("click")):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}}))):"yes"==folders_media_options.useFolderUndo&&e.ajax({url:folders_media_options.ajax_url,type:"post",data:{post_type:folders_media_options.post_type,nonce:folders_media_options.nonce,action:"wcp_undo_folder_changes"},success:function(o){if(e("#undo-done").addClass("active"),e(".undo-folder-action").addClass("disabled"),setTimeout((function(){e("#undo-done").removeClass("active")}),2500),me(),e("#media-attachment-taxonomy-filter").length){var s=parent.wp;s.media!=t&&(s.media.frame.setState("insert"),null!==s.media.frame.content.get()&&void 0!==s.media.frame.content.get().collection?(s.media.frame.content.get().collection.props.set({ignore:+new Date}),s.media.frame.content.get().options.selection.reset()):s.media.frame.library.props.set({ignore:+new Date}))}}})})),e(document).on("click",".close-undo-box",(function(t){t.preventDefault(),e("#do-undo").removeClass("active")}))})),e(document).ready((function(){e(document).on("click","#remove-from-all-folders:not(.disabled), #remove-from-current-folder:not(.disabled)",(function(){e("#remove-from-all-folders, #remove-from-current-folder").addClass("disabled");var t="all";e(this).hasClass("remove-from-current-folder")&&(t="current"),e("#confirm-your-change").hide(),e.ajax({url:folders_media_options.ajax_url,data:{post_id:e("#unassigned_folders").val(),action:"wcp_remove_post_folder",active_folder:g,type:folders_media_options.post_type,folder_id:-1,nonce:folders_media_options.nonce,status:0,taxonomy:g,remove_from:t},method:"post",success:function(t){e("#remove-from-all-folders, #remove-from-current-folder").removeClass("disabled"),Ce(),me(),Z()}})})),e(document).on("click",".default-folders a",(function(t){t.preventDefault();var o=e(this).closest(".dynamic-menu").data("id"),s=de(o);if(e(".dynamic-menu").hide(),null!=s){var a=l[s].slug;folders_media_options.default_folder=a,e.ajax({url:folders_media_options.ajax_url,type:"post",data:"action=save_premio_default_folder&post_type="+folders_media_options.post_type+"&post_slug="+a+"&nonce="+folders_media_options.nonce+"&folder_id="+o,cache:!1,async:!1,success:function(){pe(),"1"==res.status&&e(".folder-modal .jstree-node[id='"+res.folder_id+"']").length&&e(".folder-modal .jstree-node[id='"+res.folder_id+"'] > a.jstree-anchor").trigger("focus")}})}})),e(document).on("click",".remove-default-folder a",(function(t){t.preventDefault(),e(".dynamic-menu").hide(),folders_media_options.default_folder="",e.ajax({url:folders_media_options.ajax_url,type:"post",data:"action=remove_premio_default_folder&post_type="+folders_media_options.post_type+"&nonce="+folders_media_options.nonce+"&folder_id="+post_id,cache:!1,async:!1,success:function(){pe(),"1"==res.status&&e(".folder-modal .jstree-node[id='"+res.folder_id+"']").length&&e(".folder-modal .jstree-node[id='"+res.folder_id+"'] > a.jstree-anchor").trigger("focus")}})})),e(document).on("click",".dynamic-menu .copy-folders",(function(t){t.stopPropagation(),O=e(this).closest(".dynamic-menu").data("id"),P="copy",e(".dynamic-menu").remove(),Ce(),e(".folders-undo-notification").removeClass("active"),e("#copy-message").addClass("active"),setTimeout((function(){e("#copy-message").removeClass("active")}),5e3),ae(),e(".folder-modal .jstree-node[id='"+O+"']").length&&e(".folder-modal .jstree-node[id='"+O+"'] > a.jstree-anchor").trigger("focus")})),e(document).on("click",".dynamic-menu .cut-folders",(function(t){t.stopPropagation(),O=e(this).closest(".dynamic-menu").data("id"),P="cut",e(".dynamic-menu").remove(),Ce(),e(".folders-undo-notification").removeClass("active"),e("#cut-message").addClass("active"),setTimeout((function(){e("#cut-message").removeClass("active")}),5e3),ae(),e(".folder-modal .jstree-node[id='"+O+"']").length&&e(".folder-modal .jstree-node[id='"+O+"'] > a.jstree-anchor").trigger("focus")})),e(document).on("click",".dynamic-menu .paste-folders",(function(t){t.stopPropagation();var o=e(this).closest(".dynamic-menu").data("id");0!=O&&""!=O&&o!=O&&("cut"==P?"custom"==O?e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0&&(e(".folder-modal #js-tree-menu input.checkbox:checked").each((function(){O=parseInt(e(this).closest("li.jstree-node").attr("id")),""!=o&&0!=o?e(".folder-modal #js-tree-menu").jstree("move_node","#"+O,"#"+o,0):e(".folder-modal #js-tree-menu").jstree("move_node","#"+O,"#",e("#js-tree-menu > ul > li.jstree-node").length)})),e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active")}),5e3),O=""):(L=e("#"+O).data("parent"),N=O,e("#"+O).index(),e(".folder-modal #js-tree-menu").jstree("move_node","#"+O,"#"+o,0),A="cut",e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active"),0,L=0}),5e3),e(".folder-modal .jstree-node[id='"+o+"']").length&&e(".folder-modal .jstree-node[id='"+o+"'] > a.jstree-anchor").trigger("focus")):oe(O,o),ae(),P="",O=0),e(".dynamic-menu").remove()})),e(document).on("click",".paste-folder-action",(function(){(""==g||isNaN(g))&&(g=0),0!=O&&""!=O&&O!=g&&("cut"==P?"custom"==O?e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0&&(e(".folder-modal #js-tree-menu input.checkbox:checked").each((function(){O=parseInt(e(this).closest("li.jstree-node").attr("id")),""!=g&&0!=g?e(".folder-modal #js-tree-menu").jstree("move_node","#"+O,"#"+g,0):e(".folder-modal #js-tree-menu").jstree("move_node","#"+O,"#",e("#js-tree-menu > ul > li.jstree-node").length)})),e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active")}),5e3)):(L=e("#"+O).data("parent"),N=O,e("#"+O).index()+1,""!=g&&0!=g?e("#js-tree-menu").jstree("move_node","#"+O,"#"+g,0):e("#js-tree-menu").jstree("move_node","#"+O,"#",e("#js-tree-menu > ul > li.jstree-node").length),e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active")}),5e3),e(".folder-modal .jstree-node[id='"+g+"']").length&&e(".folder-modal .jstree-node[id='"+g+"'] > a.jstree-anchor").trigger("focus")):((""==g||isNaN(g))&&(g=0),oe(O,g)),ae(),P="",O=0)})),e(document).on("click",".cut-folder-action",(function(t){t.stopPropagation(),e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0?(O="custom",P="cut",e(".folders-undo-notification").removeClass("active"),e("#cut-message").addClass("active"),setTimeout((function(){e("#cut-message").removeClass("active")}),5e3),ae()):""!=g&&0!=g&&(O=g,P="cut",e(".folders-undo-notification").removeClass("active"),e("#cut-message").addClass("active"),setTimeout((function(){e("#cut-message").removeClass("active")}),5e3),ae(),e(".jstree-node[id='"+O+"']").length&&e(".jstree-node[id='"+O+"'] > a.jstree-anchor").trigger("focus"))})),e(document).on("click",".copy-folder-action",(function(t){t.stopPropagation(),e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0?(O="custom",P="copy",e(".folders-undo-notification").removeClass("active"),e("#copy-message").addClass("active"),setTimeout((function(){e("#copy-message").removeClass("active")}),5e3),ae()):""!=g&&0!=g&&(O=g,P="copy",e(".folders-undo-notification").removeClass("active"),e("#copy-message").addClass("active"),setTimeout((function(){e("#copy-message").removeClass("active")}),5e3),ae(),e(".folder-modal .jstree-node[id='"+g+"']").length&&e(".folder-modal .jstree-node[id='"+g+"'] > a.jstree-anchor").trigger("focus"))})),"attachment"==folders_media_options.post_type&&e(".upload-media-action").removeClass("disabled")})),e(document).ready((function(){"yes"==folders_media_options.use_shortcuts&&(e(document).on("click",".view-shortcodes",(function(t){t.preventDefault(),e("#keyboard-shortcut").show()})),e(document).on("keydown",(function(t){var o=!(!t.ctrlKey&&!t.metaKey);if(e("input").is(":focus")||e("textarea").is(":focus")||!t.altKey||78!=t.keyCode&&78!=t.which||(t.preventDefault(),e("#add-new-folder").trigger("click")),113!=t.keyCode&&113!=t.which||e("#js-tree-menu .jstree-anchor").is(":focus")&&(m=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),ge(),e(".dynamic-menu").remove()),!o||67!=t.keyCode&&67!=t.which||(e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0?(O="custom",P="copy",e(".folders-undo-notification").removeClass("active"),e("#copy-message").addClass("active"),setTimeout((function(){e("#copy-message").removeClass("active")}),5e3),ae()):e("#js-tree-menu .jstree-anchor").is(":focus")&&(O=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),P="copy",e(".folders-undo-notification").removeClass("active"),e("#copy-message").addClass("active"),setTimeout((function(){e("#copy-message").removeClass("active")}),5e3),ae())),!o||88!=t.keyCode&&88!=t.which||(e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0?(O="custom",P="cut",e(".folders-undo-notification").removeClass("active"),e("#cut-message").addClass("active"),setTimeout((function(){e("#cut-message").removeClass("active")}),5e3),ae()):e("#js-tree-menu .jstree-anchor").is(":focus")&&(t.preventDefault(),O=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),P="cut",e(".folders-undo-notification").removeClass("active"),e("#cut-message").addClass("active"),setTimeout((function(){e("#cut-message").removeClass("active")}),5e3),ae())),!o||86!=t.keyCode&&86!=t.which||e("#js-tree-menu .jstree-anchor").is(":focus")&&(t.preventDefault(),(""==(g=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"))||isNaN(g))&&(g=0),0!=O&&""!=O&&O!=g&&("cut"==P?(L=e("#"+O).data("parent"),N=O,e("#"+O).index()+1,""!=g&&0!=g?e("#js-tree-menu").jstree("move_node","#"+O,"#"+g,0):e("#js-tree-menu").jstree("move_node","#"+O,"#",e("#js-tree-menu > ul > li.jstree-node").length),e(".folders-undo-notification").removeClass("active"),e("#paste-message").addClass("active"),setTimeout((function(){e("#paste-message").removeClass("active")}),5e3)):((""==g||isNaN(g))&&(g=0),oe(O,g)),ae(),P="",O=0)),!o||68!=t.keyCode&&68!=t.which||e("#js-tree-menu .jstree-anchor").is(":focus")&&(t.preventDefault(),m=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),e(".dynamic-menu").remove(),y=!1,C=!0,e("#add-update-folder-title").text(folders_media_options.lang.DUPLICATING_FOLDER),je()),!o||75!=t.keyCode&&75!=t.which||e("#keyboard-shortcut").show(),46!=t.keyCode&&46!=t.which&&8!=t.keyCode&&8!=t.which||(e("#menu-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0?e(".delete-folder-action").trigger("click"):e("#js-tree-menu .jstree-anchor").is(":focus")&&(e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").hasClass("is-locked")||(m=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),ve(0),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu")))),o&&(40==t.keyCode||40==t.which)&&e("#js-tree-menu .jstree-anchor").is(":focus")){m=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id");var s=parseInt(e("#"+m).data("parent")),a=parseInt(e("#"+m).index())+1,r=parseInt(e("#"+m).data("child"));isNaN(s)&&(s=e("li#"+m).parents("li.jstree-node").length?e("li#"+m).parents("li.jstree-node").data("folder"):0,r=e("li#"+m).parents("li.jstree-node").length?e("li#"+m).parents("li.jstree-node").children():e("#js-tree-menu > ul > li").length),0==s&&(s=""),r==a?e("#js-tree-menu").jstree("move_node","#"+m,"#"+s,0):e("#js-tree-menu").jstree("move_node","#"+m,"#"+s,a+1)}if(o&&(38==t.keyCode||38==t.which)&&e("#js-tree-menu .jstree-anchor").is(":focus")){m=e("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id");s=parseInt(e("#"+m).data("parent")),a=parseInt(e("#"+m).index())-1,r=parseInt(e("#"+m).data("child"));isNaN(s)&&(a=parseInt(e("#"+m).index())-1,s=e("li#"+m).parents("li.jstree-node").length?e("li#"+m).parents("li.jstree-node").data("folder"):0,r=e("li#"+m).parents("li.jstree-node").length?e("li#"+m).parents("li.jstree-node").children():e("#js-tree-menu > ul > li").length),0==s&&(s=""),-1==a?e("#js-tree-menu").jstree("move_node","#"+m,"#"+s,r):e("#js-tree-menu").jstree("move_node","#"+m,"#"+s,a)}27!=t.keyCode&&27!=t.which||e(".folder-popup-form").hide()})))}))}));